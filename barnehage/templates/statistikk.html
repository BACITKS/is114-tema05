{% extends 'base.html' %}

{% block content %}
<h2>Statistikk for Barn 1-2 År</h2>

<form method="post">
    <label for="kommune">Skriv inn kommunenavn:</label>
    <input type="text" id="kommune" name="kommune" required>
    <button type="submit">Vis Statistikk</button>
</form>

{% if error %}
    <p style="color: red;">{{ error }}</p>
{% endif %}

{% if chart_json %}
    <h3>Andel barn 1-2 år i barnehage i {{ kommune.capitalize() }}</h3>
    <div id="chart"></div>
    <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
    <script type="text/javascript">
        var chartData = {{ chart_json | safe }};
        vegaEmbed('#chart', chartData).catch(error => {
            console.error("Error embedding Vega chart:", error);
            document.getElementById("chart").innerHTML = "<p style='color: red;'>En feil oppstod under lasting av grafen.</p>";
        });
    </script>
{% endif %}

{% endblock %}

